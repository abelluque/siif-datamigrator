<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	template="../template/ui.xhtml">

	<ui:define name="body">
		<h3>Data Migrator :: Panel de Control</h3>

		<h:form id="mappingsForm">

			<p:dataTable
				id="tableMappings"
				var="tableMapping"
				value="#{homeImporterManagedBean.mpfusersTMList}"
				style="width:100%; height=2000px;"
				rows="5"
				paginator="true"
				selection="singleMode">

				<f:facet name="header">
			           Mapeo de tablas
			    </f:facet>
				<p:column
					headerText="Tabla"
					style="width:200px">
					<h:outputText value="#{tableMapping.tableName}" />
				</p:column>
				<p:column
					headerText="Entity"
					style="width:500%">
					<h:outputText value="#{tableMapping.className}" />
				</p:column>
				<p:column
					headerText="BB.DD."
					style="width:100px">
					<h:outputText value="#{tableMapping.dbName}" />
				</p:column>
				<p:column
					headerText="ID Column"
					style="width:100%">
					<h:outputText value="#{tableMapping.idColumnName}" />
				</p:column>
				<p:column
					headerText="ID Column Type"
					style="width:100%">
					<h:outputText value="#{tableMapping.idColumnType}" />
				</p:column>
				<f:facet name="footer">
					<p:commandButton
						id="importAction"
						value="Regenerar mapeos"
						action="#{homeImporterManagedBean.generateMappings}" />
				</f:facet>

			</p:dataTable>
		</h:form>

		<h:form id="importerForm">
			<p:dataTable
				id="importTable"
				var="importTable"
				value="#{homeImporterManagedBean.dataImported}"
				style="width:100%; height=2000px;"
				rows="5"
				paginator="true"
				selection="single">

				<f:facet name="header">
			           Últimos datos importados
			    </f:facet>
				
				<p:column
					headerText="Tabla"
					style="width:200px">
					<h:outputText value="#{importTable.tableName}" />
				</p:column>
				<p:column
					headerText="Información"
					style="width:500%">
					<h:outputText value="#{importTable.informacion}" />
				</p:column>
				<p:column
					headerText="Fecha"
					style="width:100%">
					<h:outputText value="#{importTable.creationDate}" />
				</p:column>

				<f:facet name="footer">
					<p:commandButton
						id="importAction"
						value="Importar"
						action="#{homeImporterManagedBean.importDbInfo}" />
				</f:facet>

			</p:dataTable>
		</h:form>

	</ui:define>
</ui:composition>